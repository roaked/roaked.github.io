<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Genetic Tuning for Smarter Deep Q-Learning # Currently working on this (some functions are already outdated) # 1. Snake Game # The Snake game has served as a fundamental project for programming novices due to its simplicity and versatility. In this work, Pygame is used, a Python library designed for game development, to create a Snake game environment. The core motivation is to provide a controlled and adaptable setting for AI development and reinforcement learning combined with metaheuristics."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="Snake Game: Genetic RL-DQN"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://xsleaks.dev/docs/code/snake-game/"><title>Snake Game: Genetic RL-DQN | Ricardo Chin</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=stylesheet href=/book.min.b74e85bd7803de00c09a320dcf09ae0d7e37702a9918995f5fe9d1c71c55a223.css integrity="sha256-t06FvXgD3gDAmjINzwmuDX43cCqZGJlfX+nRxxxVoiM=" crossorigin=anonymous><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-10WQY47KS2"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-10WQY47KS2",{anonymize_ip:!1})}</script><link rel=alternate type=application/rss+xml href=https://xsleaks.dev/docs/code/snake-game/index.xml title="Ricardo Chin"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Ricardo Chin</span></a></h2><ul><li class=book-section-flat><a href=/docs/design/>Design Repository</a><ul><li><a href=/docs/design/fea-beam-simulation/>FEA Beam Instability Modes</a><ul></ul></li><li><a href=/docs/design/industrial-crane-design/>Industrial Crane Design</a><ul></ul></li><li><a href=/docs/design/finite-element-method-development/>FEM Package Development</a><ul></ul></li><li><a href=/docs/design/manual-transmission-design/>Manual Transmission Design</a><ul></ul></li><li><a href=/docs/design/electron-beam-tech/>Electron Beam Technology</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/docs/code/>Coding Repository</a><ul><li><a href=/docs/code/uav/>UAV Red Bull Air Racing</a><ul><li><a href=/docs/code/uav/dynamics/>Drone Dynamics</a></li><li><a href=/docs/code/uav/continuous-controller-design/>Drone Controller Design Pt. 1</a></li><li><a href=/docs/code/uav/discrete-controller-design/>Drone Controller Design Pt. 2</a></li><li><a href=/docs/code/uav/computer-vision/>Drone Computer Vision</a></li></ul></li><li><a href=/docs/code/agv/>AGV: System Identification</a><ul></ul></li><li><a href=/docs/code/deep-learning-fake-news/>Deep Learning on Fake News</a><ul></ul></li><li><a href=/docs/code/hamiltonian-graphs/hamiltonian/>Hamiltonian Graphs: Linked Lists</a></li><li><a href=/docs/code/bin-packing/>EC Optimization: Space & Time</a><ul><li><a href=/docs/code/bin-packing/genetic-algorithm/>Genetic Algorithm</a></li><li><a href=/docs/code/bin-packing/particle-swarm-optimization/>Particle Swarm Optimization</a></li></ul></li><li><a href=/docs/code/snake-game/ class=active>Snake Game: Genetic RL-DQN</a><ul></ul></li><li><a href=/docs/code/pybamm-ml-battery/>PyBaMM-ML EV Battery Status</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/docs/competitions/>Academic Competitions</a><ul><li><a href=/docs/competitions/fst/>Formula Student Lisbon</a></li><li><a href=/docs/competitions/thermocup/>ThermoCup</a></li></ul></li><li class=book-section-flat><a href=/docs/leet/>My LeetCode Solutions</a><ul></ul></li><li class=book-section-flat><a href=/docs/mod/>Website Modifications</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Snake Game: Genetic RL-DQN</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#1-snake-game>1. Snake Game</a></li><li><a href=#2-import-pygame--user-controlled-snake-game>2. import pygame / User Controlled Snake Game</a></li><li><a href=#3-reinforcement-deep-q-network-model>3. Reinforcement Deep Q-Network Model</a></li></ul></nav></aside></header><article class=markdown><h1 id=genetic-tuning-for-smarter-deep-q-learning>Genetic Tuning for Smarter Deep Q-Learning
<a class=anchor href=#genetic-tuning-for-smarter-deep-q-learning>#</a></h1><p><img src=https://miro.medium.com/v2/resize:fit:2800/1*zRZ46MeFZMd5F52CHM6EYA.png alt=213d></p><h1 id=currently-working-on-this-some-functions-are-already-outdated>Currently working on this (some functions are already outdated)
<a class=anchor href=#currently-working-on-this-some-functions-are-already-outdated>#</a></h1><h2 id=1-snake-game>1. Snake Game
<a class=anchor href=#1-snake-game>#</a></h2><p>The Snake game has served as a fundamental project for programming novices due to its simplicity and versatility. In this work, Pygame is used, a Python library designed for game development, to create a Snake game environment. The core motivation is to provide a controlled and adaptable setting for AI development and reinforcement learning combined with metaheuristics.</p><h2 id=2-import-pygame--user-controlled-snake-game>2. import pygame / User Controlled Snake Game
<a class=anchor href=#2-import-pygame--user-controlled-snake-game>#</a></h2><blockquote class="book-hint2 important"><p class="hint-title important"><svg class="book-icon"><use href="/svg/hint-icons.svg#important-notice"/></svg><span>important</span></p>Most of the code for the game implementation was adapted using Pygame for providing a robust framework for game development in Python. &ndash; <a href=pygame.org/docs>Pygame Documentation</a></blockquote><p>The code begins with initializing Pygame and setting up essential game parameters such as window size, colors, and game speed. Pygame&rsquo;s functionalities are leveraged for window creation, event handling, and display rendering.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> random<span style=color:#f92672>,</span> pygame<span style=color:#f92672>,</span> sys<span style=color:#f92672>,</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Pygame initialization and window setup</span>
</span></span><span style=display:flex><span>check_errors <span style=color:#f92672>=</span> pygame<span style=color:#f92672>.</span>init()
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> check_errors[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;[!] Had </span><span style=color:#e6db74>{</span>check_errors[<span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74> errors when initializing game, exiting...&#39;</span>)
</span></span><span style=display:flex><span>    sys<span style=color:#f92672>.</span>exit(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;[+] Game successfully initialized&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Defined other variables here, adapt fontsize, window size, colors, speed, block size, etc...</span>
</span></span></code></pre></div><p>In addition, SnakeGameAI Class is defined which encapsulates the game logic, managing the game state, snake movement, collision detection, and food placement.</p><blockquote class="book-hint2 important"><p class="hint-title important"><svg class="book-icon"><use href="/svg/hint-icons.svg#important-notice"/></svg><span>important</span></p><p>Vital functions encompass:</p><ul><li><code>def __init__</code> &ndash; Initializing game window and start up the game state</li><li><code>def _init_game</code> &ndash; Initialize game state variables (snake position, score, food)</li><li><code>def _place_food</code> &ndash; Places food randomly within the game window, avoiding snake collision</li><li><code>def _move</code> &ndash; Handling snake movement based on user or AI action</li><li><code>def play_step </code>&ndash; Process each step of the game based on user (and later AI actions). (in addition, collects user input, move snake, check collision, update score, etc.)</li></ul></blockquote><p>Given <code>__init__</code> and <code>__init__game</code> functions, the snake is initialized with a starting position, consisting of three body parts (self.head and two segments) positioned horizontally to the right. The game also tracks the score, food, and frame iteration (for managing game duration).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_init_game</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#75715e># Initializing game state variables (snake position, score, food)</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>direction <span style=color:#f92672>=</span> Direction<span style=color:#f92672>.</span>RIGHT
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>head <span style=color:#f92672>=</span> Point(self<span style=color:#f92672>.</span>width <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, self<span style=color:#f92672>.</span>height <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>snake <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>head,
</span></span><span style=display:flex><span>            Point(self<span style=color:#f92672>.</span>head<span style=color:#f92672>.</span>x <span style=color:#f92672>-</span> BLOCK_SIZE, self<span style=color:#f92672>.</span>head<span style=color:#f92672>.</span>y),
</span></span><span style=display:flex><span>            Point(self<span style=color:#f92672>.</span>head<span style=color:#f92672>.</span>x <span style=color:#f92672>-</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> BLOCK_SIZE), self<span style=color:#f92672>.</span>head<span style=color:#f92672>.</span>y)
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>score <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>food <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>frame_iteration <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_place_food()
</span></span></code></pre></div><p>After snake initialization, the <code>_move</code> function adjusts the snake&rsquo;s direction based on the received action (from user or AI). It updates the snake&rsquo;s position accordingly, controlling its movement either left, right, up, or down.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_move</span>(self, action):
</span></span><span style=display:flex><span>        <span style=color:#75715e># [straight, right, left]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        clock_wise <span style=color:#f92672>=</span> [Direction<span style=color:#f92672>.</span>RIGHT, Direction<span style=color:#f92672>.</span>DOWN, Direction<span style=color:#f92672>.</span>LEFT, Direction<span style=color:#f92672>.</span>UP]
</span></span><span style=display:flex><span>        idx <span style=color:#f92672>=</span> clock_wise<span style=color:#f92672>.</span>index(self<span style=color:#f92672>.</span>direction)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> np<span style=color:#f92672>.</span>array_equal(action, [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]):
</span></span><span style=display:flex><span>            new_dir <span style=color:#f92672>=</span> clock_wise[idx] <span style=color:#75715e># No change</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> np<span style=color:#f92672>.</span>array_equal(action, [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>]):
</span></span><span style=display:flex><span>            next_idx <span style=color:#f92672>=</span> (idx <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>            new_dir <span style=color:#f92672>=</span> clock_wise[next_idx] <span style=color:#75715e># right turn r -&gt; d -&gt; l -&gt; u</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>: <span style=color:#75715e># [0, 0, 1]</span>
</span></span><span style=display:flex><span>            next_idx <span style=color:#f92672>=</span> (idx <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>            new_dir <span style=color:#f92672>=</span> clock_wise[next_idx] <span style=color:#75715e># left turn r -&gt; u -&gt; l -&gt; d</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>direction <span style=color:#f92672>=</span> new_dir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>head<span style=color:#f92672>.</span>x
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>head<span style=color:#f92672>.</span>y
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>direction <span style=color:#f92672>==</span> Direction<span style=color:#f92672>.</span>RIGHT:
</span></span><span style=display:flex><span>            x <span style=color:#f92672>+=</span> BLOCK_SIZE
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>direction <span style=color:#f92672>==</span> Direction<span style=color:#f92672>.</span>LEFT:
</span></span><span style=display:flex><span>            x <span style=color:#f92672>-=</span> BLOCK_SIZE
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>direction <span style=color:#f92672>==</span> Direction<span style=color:#f92672>.</span>DOWN:
</span></span><span style=display:flex><span>            y <span style=color:#f92672>+=</span> BLOCK_SIZE
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>direction <span style=color:#f92672>==</span> Direction<span style=color:#f92672>.</span>UP:
</span></span><span style=display:flex><span>            y <span style=color:#f92672>-=</span> BLOCK_SIZE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>head <span style=color:#f92672>=</span> Point(x, y)
</span></span></code></pre></div><p>Afterwards, the <code>_place_food</code> function randomnly places food within the game window. It ensures the food doesn&rsquo;t spawn on the snake&rsquo;s body by repositioning it until a valid location is found.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_place_food</span>(self):
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0</span>, (self<span style=color:#f92672>.</span>width<span style=color:#f92672>-</span>BLOCK_SIZE )<span style=color:#f92672>//</span>BLOCK_SIZE )<span style=color:#f92672>*</span>BLOCK_SIZE
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>0</span>, (self<span style=color:#f92672>.</span>height<span style=color:#f92672>-</span>BLOCK_SIZE )<span style=color:#f92672>//</span>BLOCK_SIZE )<span style=color:#f92672>*</span>BLOCK_SIZE
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>food <span style=color:#f92672>=</span> Point(x, y)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>food <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>snake:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>_place_food()
</span></span></code></pre></div><p>In a similar manner, the <code>is_collision</code> function checks for collisions with the game window boundaries or the snake&rsquo;s body. If the snake hits the window boundaries or collides with itself, the game ends.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>is_collision</span>(self, pt<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> pt <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            pt <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>head
</span></span><span style=display:flex><span>        <span style=color:#75715e># hits boundary</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> pt<span style=color:#f92672>.</span>x <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>width <span style=color:#f92672>-</span> BLOCK_SIZE <span style=color:#f92672>or</span> pt<span style=color:#f92672>.</span>x <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>or</span> pt<span style=color:#f92672>.</span>y <span style=color:#f92672>&gt;</span> self<span style=color:#f92672>.</span>height <span style=color:#f92672>-</span> BLOCK_SIZE <span style=color:#f92672>or</span> pt<span style=color:#f92672>.</span>y <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>: 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># hits itself</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> pt <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>snake[<span style=color:#ae81ff>1</span>:]: 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>False</span>
</span></span></code></pre></div><p>Lastly, all previous vital functions are combined through the core function <code>play_step</code> which manages the core game loop, processing each step by collecting user input, moving the snake, and updating the game state based on collisions and food consumption & spawning. The <code>_update_ui</code> function refreshes the game display, showing the snake, food, score, and any other visual elements.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>play_step</span>(self, action):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>frame_iteration <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 1. input data from user</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> event <span style=color:#f92672>in</span> pygame<span style=color:#f92672>.</span>event<span style=color:#f92672>.</span>get():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> event<span style=color:#f92672>.</span>type <span style=color:#f92672>==</span> pygame<span style=color:#f92672>.</span>QUIT:
</span></span><span style=display:flex><span>                pygame<span style=color:#f92672>.</span>quit()
</span></span><span style=display:flex><span>                quit()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># 2. move</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_move(action) <span style=color:#75715e># update the head</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>snake<span style=color:#f92672>.</span>insert(<span style=color:#ae81ff>0</span>, self<span style=color:#f92672>.</span>head)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># 3. do we reset? / game over</span>
</span></span><span style=display:flex><span>        reward <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        game_over <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>is_collision() <span style=color:#f92672>or</span> self<span style=color:#f92672>.</span>frame_iteration <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>100</span><span style=color:#f92672>*</span>len(self<span style=color:#f92672>.</span>snake):
</span></span><span style=display:flex><span>            game_over <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>            reward <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> reward, game_over, self<span style=color:#f92672>.</span>score
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 4. place food if eaten, else keep moving</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>head <span style=color:#f92672>==</span> self<span style=color:#f92672>.</span>food:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>score <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            reward <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>_place_food()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>snake<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#75715e># 5. update ui //</span>
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>_update_ui()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>clock<span style=color:#f92672>.</span>tick(SPEED)
</span></span><span style=display:flex><span>        <span style=color:#75715e># 6. return score or game over</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> reward, game_over, self<span style=color:#f92672>.</span>score
</span></span></code></pre></div><blockquote class="book-hint2 warning"><p class="hint-title warning"><svg class="book-icon"><use href="/svg/hint-icons.svg#warning-notice"/></svg><span>warning</span></p><p>The game itself is still under development and some of the functions might have been changed already, but not updated here. Nevertheless, current tasks to further enhance the game environment and codebase consist of:</p><ul><li>Complete User Input Handling: Implement the get_user_input method to capture user actions, enabling manual control of the snake.</li><li>Display Rendering: Develop the _update_display method to visually represent the game state using Pygame&rsquo;s rendering capabilities.</li><li>Enhancements: Explore additional features such as different game difficulty levels, multiplayer functionalities, or advanced AI algorithms to enrich the gaming experience.</li></ul></blockquote><h2 id=3-reinforcement-deep-q-network-model>3. Reinforcement Deep Q-Network Model
<a class=anchor href=#3-reinforcement-deep-q-network-model>#</a></h2></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/roaked/roaked.github.io/commit/403e253c38fb0992fee61674638008d7d4cd691d title='Last modified by roaked | December 15, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>December 15, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/roaked/roaked.github.io/edit/main/content/content/docs/code/snake-game/_index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Ricardo Chin</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1-snake-game>1. Snake Game</a></li><li><a href=#2-import-pygame--user-controlled-snake-game>2. import pygame / User Controlled Snake Game</a></li><li><a href=#3-reinforcement-deep-q-network-model>3. Reinforcement Deep Q-Network Model</a></li></ul></nav></div></aside></main></body></html>