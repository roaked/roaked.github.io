<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  AI Pioneer Debut: Maze SLAM
  #

According to many sources, &ldquo;the first system (&mldr;) is the Theseus. It was built by Claude Shannon in 1950 and was a remote-controlled mouse that was able to find its way out of a labyrinth and could remember its course.  In seven decades, the abilities of artificial intelligence have come a long way.

  Code References (GitHub Methods)
  #


Repository root
Search: simulation functions
Search: Flood Fill functions
Search: A* functions
Search: map/wall update methods
Search: step/move methods


  
    
      
        
      note"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://xsleaks.dev/docs/code/micromouse/"><meta property="og:site_name" content="Ricardo Chin"><meta property="og:title" content="Micromouse: Flood Fill and A*"><meta property="og:description" content="AI Pioneer Debut: Maze SLAM # According to many sources, “the first system (…) is the Theseus. It was built by Claude Shannon in 1950 and was a remote-controlled mouse that was able to find its way out of a labyrinth and could remember its course. In seven decades, the abilities of artificial intelligence have come a long way.
Code References (GitHub Methods) # Repository root Search: simulation functions Search: Flood Fill functions Search: A* functions Search: map/wall update methods Search: step/move methods note"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Micromouse: Flood Fill and A* | Ricardo Chin</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=stylesheet href=/book.min.b1824eea1873de6fd466b2e1d8cc26a9f8e6e7aaf317af5779752ac8f255d4c4.css integrity="sha256-sYJO6hhz3m/UZrLh2Mwmqfjm56rzF69XeXUqyPJV1MQ=" crossorigin=anonymous><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://xsleaks.dev/docs/code/micromouse/index.xml title="Ricardo Chin"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Ricardo Chin</span></a></h2><ul><li class=book-section-flat><a href=/docs/design/>Engineering Repository</a><ul><li><a href=/docs/design/finite-element-method-development/>FEM Package Development</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/docs/code/>System Repository</a><ul><li><a href=/docs/code/agv/>AGV: Stochastic Identification</a><ul></ul></li><li><a href=/docs/code/uav/>UAV: Red Bull Air Racing</a><ul><li><a href=/docs/code/uav/dynamics/>Drone System Dynamics</a></li><li><a href=/docs/code/uav/continuous-controller-design/>Continuous Controller</a></li><li><a href=/docs/code/uav/discrete-controller-design/>Discrete Controller</a></li><li><a href=/docs/code/uav/computer-vision/>Gate Sense: Computer Vision</a></li></ul></li><li><a href=/docs/code/robotics/>Robotics: Kin, Dynamics & Control</a><ul></ul></li><li><a href=/docs/code/micromouse/ class=active>Micromouse: Flood Fill and A*</a><ul></ul></li><li><a href=/docs/code/bin-packing/>EC Optimization: Space & Time</a><ul><li><a href=/docs/code/bin-packing/genetic-algorithm/>Genetic Algorithm</a></li><li><a href=/docs/code/bin-packing/particle-swarm-optimization/>Particle Swarm Optimization</a></li></ul></li><li><a href=/docs/code/snake-game/>Snake: Reinforcement Learning</a><ul><li><a href=/docs/code/snake-game/deepqnetwork/>BaseRL, GA-RL & Hamiltonian</a></li><li><a href=/docs/code/snake-game/adversarial/>Adversarial Multi-Agent RL, BattleMode</a></li></ul></li><li><a href=/docs/code/deep-learning-fake-news/>Fake News: Inference & Clusters</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/docs/lectures/>My Notes and Lectures</a><ul><li><a href=/docs/lectures/bayesian-machine-learning/bayes/>Bayesian Inference</a></li><li><a href=/docs/lectures/bayesian-optimization/bayesopt/>Bayesian Optimization</a></li><li><a href=/docs/lectures/nonlinear-programming/nonlinear/>Nonlinear Programming</a></li><li><a href=/docs/lectures/hamiltonian-graphs/hamiltonian/>Hamiltonian Graphs & Linked Lists</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Micromouse: Flood Fill and A*</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#code-references-github-methods><strong>Code References (GitHub Methods)</strong></a></li><li><a href=#1-purpose-of-the-simulation-function><strong>1) Purpose of the Simulation Function</strong></a></li><li><a href=#2-expected-function-contract><strong>2) Expected Function Contract</strong></a><ul><li><a href=#inputs>Inputs</a></li><li><a href=#outputs>Outputs</a></li></ul></li><li><a href=#3-per-step-simulation-pipeline><strong>3) Per-Step Simulation Pipeline</strong></a></li><li><a href=#4-mapping-layer-why-it-matters><strong>4) Mapping Layer: Why It Matters</strong></a></li><li><a href=#5-planning-layer-flood-fill-and-a><strong>5) Planning Layer: Flood Fill and A*</strong></a><ul><li><a href=#flood-fill-usage-in-simulation>Flood Fill usage in simulation</a></li><li><a href=#a-usage-in-simulation>A* usage in simulation</a></li></ul></li><li><a href=#6-controller--safety-checks><strong>6) Controller + Safety Checks</strong></a></li><li><a href=#7-termination-conditions><strong>7) Termination Conditions</strong></a></li><li><a href=#8-metrics-you-should-always-record><strong>8) Metrics You Should Always Record</strong></a></li><li><a href=#9-instrumented-full-example><strong>9) Instrumented Full Example</strong></a></li></ul></nav></aside></header><article class=markdown><h1 id=ai-pioneer-debut-maze-slam>AI Pioneer Debut: Maze SLAM
<a class=anchor href=#ai-pioneer-debut-maze-slam>#</a></h1><p><a href="https://webmuseum.mit.edu/detail.php?module=objects&amp;type=related&amp;kv=76066">According to many sources</a>, &ldquo;the first system (&mldr;) is the Theseus. It was built by <em>Claude Shannon</em> in 1950 and was a remote-controlled mouse that was able to find its way out of a labyrinth and could remember its course. In seven decades, the abilities of artificial intelligence have come a long way.</p><h2 id=code-references-github-methods><strong>Code References (GitHub Methods)</strong>
<a class=anchor href=#code-references-github-methods>#</a></h2><ul><li><a href=https://github.com/roaked/micromouse>Repository root</a></li><li><a href="https://github.com/roaked/micromouse/search?q=simulation&amp;type=code">Search: simulation functions</a></li><li><a href="https://github.com/roaked/micromouse/search?q=flood+fill&amp;type=code">Search: Flood Fill functions</a></li><li><a href="https://github.com/roaked/micromouse/search?q=astar&amp;type=code">Search: A* functions</a></li><li><a href="https://github.com/roaked/micromouse/search?q=wall+update&amp;type=code">Search: map/wall update methods</a></li><li><a href="https://github.com/roaked/micromouse/search?q=step+move&amp;type=code">Search: step/move methods</a></li></ul><blockquote class="book-hint2 note"><p class="hint-title note"><svg class="book-icon"><use href="/svg/hint-icons.svg#note-notice"/></svg><span>note</span></p><ul><li>Use the links above as jump points to bind each section below to concrete methods as the repository evolves.</li></ul></blockquote><h2 id=1-purpose-of-the-simulation-function><strong>1) Purpose of the Simulation Function</strong>
<a class=anchor href=#1-purpose-of-the-simulation-function>#</a></h2><p>The simulation function is the runtime coordinator that executes one complete micromouse episode:</p><ol><li>initialize maze, robot pose, and planner state</li><li>run repeated sensing/mapping/planning/control updates</li><li>stop on goal or failure conditions</li><li>return metrics for evaluation and debugging</li></ol><p>In practice, this function is the &ldquo;single source of truth&rdquo; for experiment reproducibility because every policy and planner goes through the same loop contract.</p><h2 id=2-expected-function-contract><strong>2) Expected Function Contract</strong>
<a class=anchor href=#2-expected-function-contract>#</a></h2><p>A typical simulation signature follows this shape:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_simulation</span>(
</span></span><span style=display:flex><span>    maze,
</span></span><span style=display:flex><span>    planner,
</span></span><span style=display:flex><span>    start<span style=color:#f92672>=</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    goal_cells<span style=color:#f92672>=</span>((<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>7</span>), (<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>8</span>), (<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>7</span>), (<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>8</span>)),
</span></span><span style=display:flex><span>    max_steps<span style=color:#f92672>=</span><span style=color:#ae81ff>10_000</span>,
</span></span><span style=display:flex><span>    random_seed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>):
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><h3 id=inputs>Inputs
<a class=anchor href=#inputs>#</a></h3><ul><li><code>maze</code>: ground-truth wall structure used by sensor emulation</li><li><code>planner</code>: route generator (<code>flood_fill</code>, <code>a_star</code>, or hybrid)</li><li><code>start</code>: initial robot cell and heading</li><li><code>goal_cells</code>: target center cells</li><li><code>max_steps</code>: hard cap to prevent infinite loops</li></ul><h3 id=outputs>Outputs
<a class=anchor href=#outputs>#</a></h3><p>The function should return rich diagnostics, not only success/fail:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;reached_goal&#34;</span>: bool,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;steps&#34;</span>: int,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;path&#34;</span>: list[tuple[int, int]],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;replans&#34;</span>: int,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;collisions&#34;</span>: int,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;visited_cells&#34;</span>: int,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;time_ms&#34;</span>: float,
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=3-per-step-simulation-pipeline><strong>3) Per-Step Simulation Pipeline</strong>
<a class=anchor href=#3-per-step-simulation-pipeline>#</a></h2><p>At each simulation timestep, the function should apply the same deterministic order:</p><ol><li><strong>sense</strong> nearby walls/corridors</li><li><strong>update</strong> internal occupancy/wall map</li><li><strong>plan</strong> next move or path prefix</li><li><strong>validate</strong> the action (no wall crossing)</li><li><strong>execute</strong> movement and heading update</li><li><strong>log</strong> metrics for post-run analysis</li></ol><p>Representative loop skeleton:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> range(max_steps):
</span></span><span style=display:flex><span>    local_obs <span style=color:#f92672>=</span> sense_walls(maze_truth, state<span style=color:#f92672>.</span>pose)
</span></span><span style=display:flex><span>    state<span style=color:#f92672>.</span>map <span style=color:#f92672>=</span> update_internal_map(state<span style=color:#f92672>.</span>map, state<span style=color:#f92672>.</span>pose, local_obs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> planner<span style=color:#f92672>.</span>name <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;flood_fill&#34;</span>:
</span></span><span style=display:flex><span>        cost_map <span style=color:#f92672>=</span> compute_flood_costs(state<span style=color:#f92672>.</span>map, goal_cells)
</span></span><span style=display:flex><span>        action <span style=color:#f92672>=</span> select_best_neighbor(state<span style=color:#f92672>.</span>pose, cost_map, state<span style=color:#f92672>.</span>map)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:  <span style=color:#75715e># A*</span>
</span></span><span style=display:flex><span>        path <span style=color:#f92672>=</span> a_star_path(state<span style=color:#f92672>.</span>map, state<span style=color:#f92672>.</span>pose<span style=color:#f92672>.</span>cell, goal_cells)
</span></span><span style=display:flex><span>        action <span style=color:#f92672>=</span> path_to_action(state<span style=color:#f92672>.</span>pose, path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> action <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;stuck&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    state<span style=color:#f92672>.</span>pose <span style=color:#f92672>=</span> apply_action(state<span style=color:#f92672>.</span>pose, action)
</span></span><span style=display:flex><span>    state<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>append(state<span style=color:#f92672>.</span>pose<span style=color:#f92672>.</span>cell)
</span></span></code></pre></div><h2 id=4-mapping-layer-why-it-matters><strong>4) Mapping Layer: Why It Matters</strong>
<a class=anchor href=#4-mapping-layer-why-it-matters>#</a></h2><p>Simulation quality depends on strict separation between:</p><ul><li><strong>ground truth maze</strong> (never directly leaked to planner)</li><li><strong>discovered map</strong> (incrementally built from sensor data)</li></ul><p>This prevents &ldquo;oracle behavior&rdquo; and keeps evaluation realistic.</p><p>Core responsibilities in map update methods:</p><ul><li>synchronize opposite walls between adjacent cells</li><li>mark visited cells and heading-specific observations</li><li>reject contradictory updates with assertion checks</li><li>keep grid indexing conventions consistent (<code>row,col</code> vs <code>x,y</code>)</li></ul><h2 id=5-planning-layer-flood-fill-and-a><strong>5) Planning Layer: Flood Fill and A*</strong>
<a class=anchor href=#5-planning-layer-flood-fill-and-a>#</a></h2><h3 id=flood-fill-usage-in-simulation>Flood Fill usage in simulation
<a class=anchor href=#flood-fill-usage-in-simulation>#</a></h3><ul><li>recompute (or incrementally update) cost-to-go map</li><li>prefer neighbors with strictly smaller potential</li><li>tie-break with heading continuity to reduce turns</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>cost[next_cell] <span style=color:#f92672>=</span> min(cost[current] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>for</span> current <span style=color:#f92672>in</span> open_neighbors(next_cell))
</span></span></code></pre></div><h3 id=a-usage-in-simulation>A* usage in simulation
<a class=anchor href=#a-usage-in-simulation>#</a></h3><ul><li>plan shortest discovered path on current map</li><li>apply admissible heuristic (Manhattan distance on grid)</li><li>re-plan whenever new wall evidence invalidates path</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>f(n) <span style=color:#f92672>=</span> g(n) <span style=color:#f92672>+</span> h(n),  where  h(n) <span style=color:#f92672>=</span> <span style=color:#f92672>|</span>x_n <span style=color:#f92672>-</span> x_goal<span style=color:#f92672>|</span> <span style=color:#f92672>+</span> <span style=color:#f92672>|</span>y_n <span style=color:#f92672>-</span> y_goal<span style=color:#f92672>|</span>
</span></span></code></pre></div><h2 id=6-controller--safety-checks><strong>6) Controller + Safety Checks</strong>
<a class=anchor href=#6-controller--safety-checks>#</a></h2><p>Before state transition, the simulation function should enforce:</p><ul><li>wall-crossing guard</li><li>bounds check</li><li>repeated-state/stagnation detection</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> crosses_wall(state<span style=color:#f92672>.</span>map, state<span style=color:#f92672>.</span>pose, action):
</span></span><span style=display:flex><span>    metrics[<span style=color:#e6db74>&#34;collisions&#34;</span>] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;invalid_action&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>break</span>
</span></span></code></pre></div><p>These checks make planner bugs visible early and avoid silent drift.</p><h2 id=7-termination-conditions><strong>7) Termination Conditions</strong>
<a class=anchor href=#7-termination-conditions>#</a></h2><p>A robust simulation function terminates on:</p><ul><li>goal reached (<code>pose.cell in goal_cells</code>)</li><li>step budget exhausted</li><li>invalid action/collision</li><li>planner returns no feasible move</li><li>stagnation threshold exceeded</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> state<span style=color:#f92672>.</span>pose<span style=color:#f92672>.</span>cell <span style=color:#f92672>in</span> goal_cells:
</span></span><span style=display:flex><span>    state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;success&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> t <span style=color:#f92672>&gt;=</span> max_steps <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>    state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;timeout&#34;</span>
</span></span></code></pre></div><h2 id=8-metrics-you-should-always-record><strong>8) Metrics You Should Always Record</strong>
<a class=anchor href=#8-metrics-you-should-always-record>#</a></h2><ul><li><code>steps_to_goal</code></li><li><code>turn_count</code></li><li><code>replan_count</code></li><li><code>unique_cells_visited</code></li><li><code>dead_end_entries</code></li><li><code>wall_update_count</code></li></ul><p>These metrics are essential for comparing planner variants, map update strategies, and heuristic tuning.</p><h2 id=9-instrumented-full-example><strong>9) Instrumented Full Example</strong>
<a class=anchor href=#9-instrumented-full-example>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_simulation</span>(maze_truth, planner, start, goal_cells, max_steps<span style=color:#f92672>=</span><span style=color:#ae81ff>10_000</span>):
</span></span><span style=display:flex><span>    state <span style=color:#f92672>=</span> init_state(start<span style=color:#f92672>=</span>start)
</span></span><span style=display:flex><span>    metrics <span style=color:#f92672>=</span> init_metrics()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> range(max_steps):
</span></span><span style=display:flex><span>        obs <span style=color:#f92672>=</span> sense_walls(maze_truth, state<span style=color:#f92672>.</span>pose)
</span></span><span style=display:flex><span>        update_ok <span style=color:#f92672>=</span> update_internal_map(state<span style=color:#f92672>.</span>map, state<span style=color:#f92672>.</span>pose, obs)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> update_ok:
</span></span><span style=display:flex><span>            state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;map_error&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        action <span style=color:#f92672>=</span> planner<span style=color:#f92672>.</span>next_action(state<span style=color:#f92672>.</span>map, state<span style=color:#f92672>.</span>pose, goal_cells)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> action <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;no_path&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> crosses_wall(state<span style=color:#f92672>.</span>map, state<span style=color:#f92672>.</span>pose, action):
</span></span><span style=display:flex><span>            metrics[<span style=color:#e6db74>&#34;collisions&#34;</span>] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;invalid_action&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        state<span style=color:#f92672>.</span>pose <span style=color:#f92672>=</span> apply_action(state<span style=color:#f92672>.</span>pose, action)
</span></span><span style=display:flex><span>        update_metrics(metrics, state)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> state<span style=color:#f92672>.</span>pose<span style=color:#f92672>.</span>cell <span style=color:#f92672>in</span> goal_cells:
</span></span><span style=display:flex><span>            state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;success&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        state<span style=color:#f92672>.</span>status <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;timeout&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> build_result(state, metrics)
</span></span></code></pre></div><blockquote class="book-hint2 important"><p class="hint-title important"><svg class="book-icon"><use href="/svg/hint-icons.svg#important-notice"/></svg><span>important</span></p><ul><li>The simulation loop is the critical integration point: sensing, mapping, planning, and control quality all surface here. If your results look unstable, debug this function first.</li></ul></blockquote><blockquote class="book-hint2 important"><p class="hint-title important"><svg class="book-icon"><use href="/svg/hint-icons.svg#important-notice"/></svg><span>important</span></p><strong>Used References:</strong></blockquote><ul><li><p><a href=http://mbed.org/users/goy5022/code/MicroMouse-v1/file/ce5b1bf38077/Headers/Mapping.h>System design for the robot (extracted from Gal Yaroslavsky)</a></p></li><li><p><a href=https://code.google.com/p/maze-solver/>Maze Simulator from Google</a></p></li><li><p><a href=https://www.researchgate.net/publication/321121617_Intelligent_Maze_Solving_Robot_Based_on_Image_Processing_and_Graph_Theory_Algorithms>Image Processing Implementation coupled with Graph Theory algo&rsquo;s (interesting paper!)</a></p></li><li><p><a href=https://www.geeksforgeeks.org/flood-fill-algorithm/>Flood-Fill Algorithm Geeks4Geeks</a></p></li><li><p><a href=https://github.com/adam2392/ieee_micromouse>Flood-Fill Implementation in C / Arduino</a></p></li><li><p><a href=https://www.geeksforgeeks.org/a-search-algorithm/>A* Algorithm Geeks4Geeks</a></p></li><li><p>Micromouse &lsquo;24 &ndash; 17/18 February</p></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/roaked/roaked.github.io/commit/20d63e8166125a4df3b12a6910ce354eca366042 title='Last modified by roaked | February 26, 2026' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 26, 2026</span></a></div><div><a class="flex align-center" href=https://github.com/roaked/roaked.github.io/edit/main/content/content/docs/code/micromouse/_index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Ricardo Chin</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#code-references-github-methods><strong>Code References (GitHub Methods)</strong></a></li><li><a href=#1-purpose-of-the-simulation-function><strong>1) Purpose of the Simulation Function</strong></a></li><li><a href=#2-expected-function-contract><strong>2) Expected Function Contract</strong></a><ul><li><a href=#inputs>Inputs</a></li><li><a href=#outputs>Outputs</a></li></ul></li><li><a href=#3-per-step-simulation-pipeline><strong>3) Per-Step Simulation Pipeline</strong></a></li><li><a href=#4-mapping-layer-why-it-matters><strong>4) Mapping Layer: Why It Matters</strong></a></li><li><a href=#5-planning-layer-flood-fill-and-a><strong>5) Planning Layer: Flood Fill and A*</strong></a><ul><li><a href=#flood-fill-usage-in-simulation>Flood Fill usage in simulation</a></li><li><a href=#a-usage-in-simulation>A* usage in simulation</a></li></ul></li><li><a href=#6-controller--safety-checks><strong>6) Controller + Safety Checks</strong></a></li><li><a href=#7-termination-conditions><strong>7) Termination Conditions</strong></a></li><li><a href=#8-metrics-you-should-always-record><strong>8) Metrics You Should Always Record</strong></a></li><li><a href=#9-instrumented-full-example><strong>9) Instrumented Full Example</strong></a></li></ul></nav></div></aside></main></body></html>