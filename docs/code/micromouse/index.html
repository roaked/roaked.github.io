<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  AI Pioneer Debut: Maze SLAM
  #

According to many sources, &ldquo;the first system (&mldr;) is the Theseus. It was built by Claude Shannon in 1950 and was a remote-controlled mouse that was able to find its way out of a labyrinth and could remember its course.  In seven decades, the abilities of artificial intelligence have come a long way.

  1) Simulation Driver (MicromouseApp._tick)
  #

The simulation loop is implemented inside _tick() and scheduled using tkinter:"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://xsleaks.dev/docs/code/micromouse/"><meta property="og:site_name" content="Ricardo Chin"><meta property="og:title" content="Micromouse: Flood Fill and A*"><meta property="og:description" content="AI Pioneer Debut: Maze SLAM # According to many sources, “the first system (…) is the Theseus. It was built by Claude Shannon in 1950 and was a remote-controlled mouse that was able to find its way out of a labyrinth and could remember its course. In seven decades, the abilities of artificial intelligence have come a long way.
1) Simulation Driver (MicromouseApp._tick) # The simulation loop is implemented inside _tick() and scheduled using tkinter:"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Micromouse: Flood Fill and A* | Ricardo Chin</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=stylesheet href=/book.min.b1824eea1873de6fd466b2e1d8cc26a9f8e6e7aaf317af5779752ac8f255d4c4.css integrity="sha256-sYJO6hhz3m/UZrLh2Mwmqfjm56rzF69XeXUqyPJV1MQ=" crossorigin=anonymous><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=alternate type=application/rss+xml href=https://xsleaks.dev/docs/code/micromouse/index.xml title="Ricardo Chin"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Ricardo Chin</span></a></h2><ul><li class=book-section-flat><a href=/docs/design/>Engineering Repository</a><ul><li><a href=/docs/design/finite-element-method-development/>FEM Package Development</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/docs/code/>System Repository</a><ul><li><a href=/docs/code/agv/>AGV: Stochastic Identification</a><ul></ul></li><li><a href=/docs/code/uav/>UAV: Red Bull Air Racing</a><ul><li><a href=/docs/code/uav/dynamics/>Drone System Dynamics</a></li><li><a href=/docs/code/uav/continuous-controller-design/>Continuous Controller</a></li><li><a href=/docs/code/uav/discrete-controller-design/>Discrete Controller</a></li><li><a href=/docs/code/uav/computer-vision/>Gate Sense: Computer Vision</a></li></ul></li><li><a href=/docs/code/robotics/>Robotics: Kin, Dynamics & Control</a><ul></ul></li><li><a href=/docs/code/micromouse/ class=active>Micromouse: Flood Fill and A*</a><ul></ul></li><li><a href=/docs/code/bin-packing/>EC Optimization: Space & Time</a><ul><li><a href=/docs/code/bin-packing/genetic-algorithm/>Genetic Algorithm</a></li><li><a href=/docs/code/bin-packing/particle-swarm-optimization/>Particle Swarm Optimization</a></li></ul></li><li><a href=/docs/code/snake-game/>Snake: Reinforcement Learning</a><ul><li><a href=/docs/code/snake-game/deepqnetwork/>BaseRL, GA-RL & Hamiltonian</a></li><li><a href=/docs/code/snake-game/adversarial/>Adversarial Multi-Agent RL, BattleMode</a></li></ul></li><li><a href=/docs/code/deep-learning-fake-news/>Fake News: Inference & Clusters</a><ul></ul></li></ul></li><li class=book-section-flat><a href=/docs/lectures/>My Notes and Lectures</a><ul><li><a href=/docs/lectures/bayesian-machine-learning/bayes/>Bayesian Inference</a></li><li><a href=/docs/lectures/bayesian-optimization/bayesopt/>Bayesian Optimization</a></li><li><a href=/docs/lectures/nonlinear-programming/nonlinear/>Nonlinear Programming</a></li><li><a href=/docs/lectures/hamiltonian-graphs/hamiltonian/>Hamiltonian Graphs & Linked Lists</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Micromouse: Flood Fill and A*</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#1-simulation-driver-><strong>1) Simulation Driver (<code>MicromouseApp._tick</code>)</strong></a><ul><li><a href=#what-this-does-precisely>What this does, precisely</a></li></ul></li><li><a href=#2-maze-representation-and-generation><strong>2) Maze Representation and Generation</strong></a><ul><li><a href=#2d-class-maze>2D (<code>class Maze</code>)</a></li><li><a href=#3d-class-maze3d>3D (<code>class Maze3D</code>)</a></li></ul></li><li><a href=#3-floodfill-explorer-internals><strong>3) Floodfill Explorer Internals</strong></a><ul><li><a href=#floodfillexplorer-2d><code>FloodFillExplorer</code> (2D)</a></li><li><a href=#floodfillexplorer3d><code>FloodFillExplorer3D</code></a></li></ul></li><li><a href=#4-a><em><em>4) A</em> Runner Internals</em>*</a><ul><li><a href=#astarrunner-2d><code>AStarRunner</code> (2D)</a></li><li><a href=#astarrunner3d><code>AStarRunner3D</code></a></li></ul></li><li><a href=#5-app-initialization-how-components-wire-together><strong>5) App Initialization: How Components Wire Together</strong></a></li><li><a href=#6-rendering-and-instrumentation><strong>6) Rendering and Instrumentation</strong></a></li><li><a href=#7-cli-entry-points><strong>7) CLI Entry Points</strong></a></li></ul></nav></aside></header><article class=markdown><h1 id=ai-pioneer-debut-maze-slam>AI Pioneer Debut: Maze SLAM
<a class=anchor href=#ai-pioneer-debut-maze-slam>#</a></h1><p><a href="https://webmuseum.mit.edu/detail.php?module=objects&amp;type=related&amp;kv=76066">According to many sources</a>, &ldquo;the first system (&mldr;) is the Theseus. It was built by <em>Claude Shannon</em> in 1950 and was a remote-controlled mouse that was able to find its way out of a labyrinth and could remember its course. In seven decades, the abilities of artificial intelligence have come a long way.</p><h2 id=1-simulation-driver-><strong>1) Simulation Driver (<code>MicromouseApp._tick</code>)</strong>
<a class=anchor href=#1-simulation-driver->#</a></h2><p>The simulation loop is implemented inside <code>_tick()</code> and scheduled using <code>tkinter</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_tick</span>(self) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>mode <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;xyz&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>flood3d<span style=color:#f92672>.</span>done:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>flood3d<span style=color:#f92672>.</span>step()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>astar3d<span style=color:#f92672>.</span>status <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;searching&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>astar_expansions):
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>astar3d<span style=color:#f92672>.</span>step()
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>astar3d<span style=color:#f92672>.</span>status <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;searching&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>astar3d<span style=color:#f92672>.</span>status <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;found&#34;</span> <span style=color:#f92672>and</span> self<span style=color:#f92672>.</span>astar3d_anim_index <span style=color:#f92672>&lt;</span> len(self<span style=color:#f92672>.</span>astar3d<span style=color:#f92672>.</span>path) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>astar3d_anim_index <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>astar3d_runner_cell <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>astar3d<span style=color:#f92672>.</span>path[self<span style=color:#f92672>.</span>astar3d_anim_index]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> self<span style=color:#f92672>.</span>flood<span style=color:#f92672>.</span>done:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>flood<span style=color:#f92672>.</span>step()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>astar<span style=color:#f92672>.</span>status <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;searching&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(self<span style=color:#f92672>.</span>astar_expansions):
</span></span><span style=display:flex><span>                self<span style=color:#f92672>.</span>astar<span style=color:#f92672>.</span>step()
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>astar<span style=color:#f92672>.</span>status <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;searching&#34;</span>:
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> self<span style=color:#f92672>.</span>astar<span style=color:#f92672>.</span>status <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;found&#34;</span> <span style=color:#f92672>and</span> self<span style=color:#f92672>.</span>astar_anim_index <span style=color:#f92672>&lt;</span> len(self<span style=color:#f92672>.</span>astar<span style=color:#f92672>.</span>path) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>astar_anim_index <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            self<span style=color:#f92672>.</span>astar_runner_cell <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>astar<span style=color:#f92672>.</span>path[self<span style=color:#f92672>.</span>astar_anim_index]
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_draw_floodfill()
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_draw_astar()
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_update_info()
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>root<span style=color:#f92672>.</span>after(self<span style=color:#f92672>.</span>tick_ms, self<span style=color:#f92672>.</span>_tick)
</span></span></code></pre></div><h3 id=what-this-does-precisely>What this does, precisely
<a class=anchor href=#what-this-does-precisely>#</a></h3><ul><li>Floodfill explorer advances by <strong>one step per frame</strong>.</li><li>A* can expand <strong>multiple nodes per frame</strong> (<code>--astar-expansions</code>).</li><li>After planning, both panels are redrawn and next frame is queued using <code>after(...)</code>.</li></ul><h2 id=2-maze-representation-and-generation><strong>2) Maze Representation and Generation</strong>
<a class=anchor href=#2-maze-representation-and-generation>#</a></h2><h3 id=2d-class-maze>2D (<code>class Maze</code>)
<a class=anchor href=#2d-class-maze>#</a></h3><ul><li><code>walls[(r,c)]</code> stores <code>N/E/S/W</code> booleans.</li><li><code>neighbor(...)</code>, <code>has_wall(...)</code>, and <code>can_move(...)</code> are movement primitives.</li><li><code>goal_cells()</code> returns center cell(s): 1 center for odd grids, 4 centers for even grids.</li></ul><p>Generation is DFS maze carving + random extra openings:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>start <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>stack <span style=color:#f92672>=</span> [start]
</span></span><span style=display:flex><span>visited <span style=color:#f92672>=</span> {start}
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> stack:
</span></span><span style=display:flex><span>    current <span style=color:#f92672>=</span> stack[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    candidates <span style=color:#f92672>=</span> [(nxt, d) <span style=color:#66d9ef>for</span> nxt, d <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>neighbors(current) <span style=color:#66d9ef>if</span> nxt <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> visited]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> candidates:
</span></span><span style=display:flex><span>        stack<span style=color:#f92672>.</span>pop()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    nxt, d <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>rng<span style=color:#f92672>.</span>choice(candidates)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_remove_wall(current, nxt, d)
</span></span><span style=display:flex><span>    visited<span style=color:#f92672>.</span>add(nxt)
</span></span><span style=display:flex><span>    stack<span style=color:#f92672>.</span>append(nxt)
</span></span></code></pre></div><p>Then it injects extra openings:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>extra_openings <span style=color:#f92672>=</span> max(<span style=color:#ae81ff>1</span>, (self<span style=color:#f92672>.</span>size <span style=color:#f92672>*</span> self<span style=color:#f92672>.</span>size) <span style=color:#f92672>//</span> <span style=color:#ae81ff>12</span>)
</span></span></code></pre></div><h3 id=3d-class-maze3d>3D (<code>class Maze3D</code>)
<a class=anchor href=#3d-class-maze3d>#</a></h3><ul><li>Extends walls to <code>N/E/S/W/U/D</code>.</li><li>Cells are indexed as <code>(z, r, c)</code>.</li><li><code>goal_cell()</code> is the middle of the top layer: <code>(levels - 1, mid, mid)</code>.</li><li>Uses the same DFS-style carving logic across 3D neighbors + random extra openings.</li></ul><h2 id=3-floodfill-explorer-internals><strong>3) Floodfill Explorer Internals</strong>
<a class=anchor href=#3-floodfill-explorer-internals>#</a></h2><h3 id=floodfillexplorer-2d><code>FloodFillExplorer</code> (2D)
<a class=anchor href=#floodfillexplorer-2d>#</a></h3><p>State model:</p><ul><li><code>known[cell][dir]</code> in <code>{UNKNOWN, OPEN, WALL}</code>.</li><li>Boundary walls are initialized as known walls.</li><li><code>distances</code> is recomputed by reverse BFS from goal set.</li></ul><p>Core update:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>step</span>(self) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>done:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>_sense_cell(self<span style=color:#f92672>.</span>position)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>distances <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_compute_distances()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>position <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>goals:
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>done <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    nxt <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>_pick_next_cell()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> nxt <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>done <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>position <span style=color:#f92672>=</span> nxt
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>trail<span style=color:#f92672>.</span>append(nxt)
</span></span><span style=display:flex><span>    self<span style=color:#f92672>.</span>steps <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>steps <span style=color:#f92672>&gt;=</span> self<span style=color:#f92672>.</span>max_steps:
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>done <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span></code></pre></div><p>Decision policy in <code>_pick_next_cell()</code>:</p><ul><li>candidate neighbors must be <code>OPEN</code> in <code>known</code>.</li><li>chooses minimum of <code>(distance_from_floodfill, goal_manhattan)</code> for tie-breaking.</li></ul><h3 id=floodfillexplorer3d><code>FloodFillExplorer3D</code>
<a class=anchor href=#floodfillexplorer3d>#</a></h3><ul><li>same pattern in XYZ space with Manhattan distance in 3 axes.</li><li>step budget scales with volume:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>self<span style=color:#f92672>.</span>max_steps <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>maze<span style=color:#f92672>.</span>size <span style=color:#f92672>*</span> self<span style=color:#f92672>.</span>maze<span style=color:#f92672>.</span>size <span style=color:#f92672>*</span> self<span style=color:#f92672>.</span>maze<span style=color:#f92672>.</span>levels <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>
</span></span></code></pre></div><h2 id=4-a><em><em>4) A</em> Runner Internals</em>*
<a class=anchor href=#4-a>#</a></h2><h3 id=astarrunner-2d><code>AStarRunner</code> (2D)
<a class=anchor href=#astarrunner-2d>#</a></h3><ul><li>Priority queue stores <code>(f_score, counter, node)</code> for deterministic tie handling.</li><li>Uses:<ul><li><code>open_heap</code> (heapq frontier)</li><li><code>open_set</code> (fast membership)</li><li><code>closed</code></li><li><code>came_from</code>, <code>g_score</code></li></ul></li></ul><p>Expansion step:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> _, _, d <span style=color:#f92672>in</span> DIRS:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>maze<span style=color:#f92672>.</span>has_wall(node, d):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    nxt <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>maze<span style=color:#f92672>.</span>neighbor(node, d)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> nxt <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>or</span> nxt <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>closed:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>    trial <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>g_score[node] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> trial <span style=color:#f92672>&lt;</span> self<span style=color:#f92672>.</span>g_score<span style=color:#f92672>.</span>get(nxt, <span style=color:#ae81ff>10</span><span style=color:#f92672>**</span><span style=color:#ae81ff>9</span>):
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>came_from[nxt] <span style=color:#f92672>=</span> node
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>g_score[nxt] <span style=color:#f92672>=</span> trial
</span></span><span style=display:flex><span>        f_score <span style=color:#f92672>=</span> trial <span style=color:#f92672>+</span> self<span style=color:#f92672>.</span>_heuristic(nxt)
</span></span><span style=display:flex><span>        heapq<span style=color:#f92672>.</span>heappush(self<span style=color:#f92672>.</span>open_heap, (f_score, self<span style=color:#f92672>.</span>_counter, nxt))
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>open_set<span style=color:#f92672>.</span>add(nxt)
</span></span></code></pre></div><p>Heuristic:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>min(abs(cell[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>-</span>g[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>+</span> abs(cell[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>-</span>g[<span style=color:#ae81ff>1</span>]) <span style=color:#66d9ef>for</span> g <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>goals)
</span></span></code></pre></div><h3 id=astarrunner3d><code>AStarRunner3D</code>
<a class=anchor href=#astarrunner3d>#</a></h3><ul><li>exactly the same engine in 3D:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>min(abs(cell[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>-</span>g[<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>+</span> abs(cell[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>-</span>g[<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>+</span> abs(cell[<span style=color:#ae81ff>2</span>]<span style=color:#f92672>-</span>g[<span style=color:#ae81ff>2</span>]) <span style=color:#66d9ef>for</span> g <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>goals)
</span></span></code></pre></div><h2 id=5-app-initialization-how-components-wire-together><strong>5) App Initialization: How Components Wire Together</strong>
<a class=anchor href=#5-app-initialization-how-components-wire-together>#</a></h2><p>In <code>MicromouseApp.__init__</code>:</p><ul><li>in <code>xyz</code> mode:<ul><li>builds <code>Maze3D</code></li><li><code>start3d = (0, size - 1, 0)</code></li><li>goal set uses <code>maze3d.goal_cell()</code></li><li>creates <code>FloodFillExplorer3D</code> + <code>AStarRunner3D</code></li></ul></li><li>in <code>2d/3d</code> modes:<ul><li>builds <code>Maze</code></li><li><code>start = (size - 1, 0)</code></li><li>goals use <code>maze.goal_cells()</code></li><li>creates <code>FloodFillExplorer</code> + <code>AStarRunner</code></li></ul></li></ul><p>This is exactly where the simulator decides which state machine and renderer will be active.</p><h2 id=6-rendering-and-instrumentation><strong>6) Rendering and Instrumentation</strong>
<a class=anchor href=#6-rendering-and-instrumentation>#</a></h2><p>The app renders two synchronized panels:</p><ul><li>left: Floodfill exploration status</li><li>right: A* search status + animated final path</li></ul><p>Important render helpers:</p><ul><li><code>_draw_floodfill_2d</code>, <code>_draw_astar_2d</code></li><li><code>_draw_floodfill_3d</code>, <code>_draw_astar_3d</code> (isometric blocks)</li><li><code>_draw_floodfill_xyz</code>, <code>_draw_astar_xyz</code> (layered Z slices with up/down arrows)</li><li><code>_update_info</code> (live status line: steps, goal reached, nodes explored)</li></ul><h2 id=7-cli-entry-points><strong>7) CLI Entry Points</strong>
<a class=anchor href=#7-cli-entry-points>#</a></h2><p>The runtime surface is explicit in <code>parse_args()</code> + <code>main()</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>p<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#34;--mode&#34;</span>, choices<span style=color:#f92672>=</span>(<span style=color:#e6db74>&#34;2d&#34;</span>, <span style=color:#e6db74>&#34;3d&#34;</span>, <span style=color:#e6db74>&#34;xyz&#34;</span>), default<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;2d&#34;</span>)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#34;--astar-expansions&#34;</span>, type<span style=color:#f92672>=</span>int, default<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>p<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#34;--levels&#34;</span>, type<span style=color:#f92672>=</span>int, default<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> MicromouseApp(<span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>app<span style=color:#f92672>.</span>run()
</span></span></code></pre></div><p>This means your “simulation function” from CLI is effectively:</p><ol><li>parse options</li><li>construct <code>MicromouseApp</code></li><li>enter <code>_tick</code> loop through <code>run()</code></li></ol><blockquote class="book-hint2 important"><p class="hint-title important"><svg class="book-icon"><use href="/svg/hint-icons.svg#important-notice"/></svg><span>important</span></p><ul><li>If behavior looks wrong, debug in this order: <code>Maze/Maze3D</code> generation → <code>FloodFillExplorer.step</code> / <code>AStarRunner.step</code> → <code>MicromouseApp._tick</code> scheduling.</li></ul></blockquote><blockquote class="book-hint2 important"><p class="hint-title important"><svg class="book-icon"><use href="/svg/hint-icons.svg#important-notice"/></svg><span>important</span></p><strong>Used References:</strong></blockquote><ul><li><p><a href=http://mbed.org/users/goy5022/code/MicroMouse-v1/file/ce5b1bf38077/Headers/Mapping.h>System design for the robot (extracted from Gal Yaroslavsky)</a></p></li><li><p><a href=https://code.google.com/p/maze-solver/>Maze Simulator from Google</a></p></li><li><p><a href=https://www.researchgate.net/publication/321121617_Intelligent_Maze_Solving_Robot_Based_on_Image_Processing_and_Graph_Theory_Algorithms>Image Processing Implementation coupled with Graph Theory algo&rsquo;s (interesting paper!)</a></p></li><li><p><a href=https://www.geeksforgeeks.org/flood-fill-algorithm/>Flood-Fill Algorithm Geeks4Geeks</a></p></li><li><p><a href=https://github.com/adam2392/ieee_micromouse>Flood-Fill Implementation in C / Arduino</a></p></li><li><p><a href=https://www.geeksforgeeks.org/a-search-algorithm/>A* Algorithm Geeks4Geeks</a></p></li><li><p>Micromouse &lsquo;24 &ndash; 17/18 February</p></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/roaked/roaked.github.io/commit/7cafd4de5b1ebf7a7c1e17d17c16715c30e2a336 title='Last modified by roaked | February 26, 2026' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>February 26, 2026</span></a></div><div><a class="flex align-center" href=https://github.com/roaked/roaked.github.io/edit/main/content/content/docs/code/micromouse/_index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Ricardo Chin</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#1-simulation-driver-><strong>1) Simulation Driver (<code>MicromouseApp._tick</code>)</strong></a><ul><li><a href=#what-this-does-precisely>What this does, precisely</a></li></ul></li><li><a href=#2-maze-representation-and-generation><strong>2) Maze Representation and Generation</strong></a><ul><li><a href=#2d-class-maze>2D (<code>class Maze</code>)</a></li><li><a href=#3d-class-maze3d>3D (<code>class Maze3D</code>)</a></li></ul></li><li><a href=#3-floodfill-explorer-internals><strong>3) Floodfill Explorer Internals</strong></a><ul><li><a href=#floodfillexplorer-2d><code>FloodFillExplorer</code> (2D)</a></li><li><a href=#floodfillexplorer3d><code>FloodFillExplorer3D</code></a></li></ul></li><li><a href=#4-a><em><em>4) A</em> Runner Internals</em>*</a><ul><li><a href=#astarrunner-2d><code>AStarRunner</code> (2D)</a></li><li><a href=#astarrunner3d><code>AStarRunner3D</code></a></li></ul></li><li><a href=#5-app-initialization-how-components-wire-together><strong>5) App Initialization: How Components Wire Together</strong></a></li><li><a href=#6-rendering-and-instrumentation><strong>6) Rendering and Instrumentation</strong></a></li><li><a href=#7-cli-entry-points><strong>7) CLI Entry Points</strong></a></li></ul></nav></div></aside></main></body></html>